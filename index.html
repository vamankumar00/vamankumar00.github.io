<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimus Capital - Complete PSX Trading API Documentation</title>
    <style>
        /* ALL EXISTING STYLES PRESERVED - keeping them as is */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: #0B0F1C;
            color: #E5E7EB;
            line-height: 1.5;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1E2329;
        }

        ::-webkit-scrollbar-thumb {
            background: #474D57;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5E6673;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #1E2329 0%, #2B3139 100%);
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 20px;
            border: 1px solid #2B3139;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(240, 185, 11, 0.1) 0%, transparent 50%);
            animation: pulse 10s infinite;
            pointer-events: none;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            color: #F0B90B;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header .subtitle {
            font-size: 16px;
            color: #A6B0C2;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .header .badge {
            background: #F0B90B;
            color: #0B0F1C;
            padding: 6px 16px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 13px;
            display: inline-block;
            position: relative;
            z-index: 1;
        }

        /* WebSocket Status */
        .ws-status {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 25px;
            flex-wrap: wrap;
        }

        .ws-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #2B3139;
            padding: 8px 16px;
            border-radius: 30px;
        }

        .ws-led {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #F6465D;
            transition: all 0.3s;
        }

        .ws-led.connected {
            background: #0ECB81;
            box-shadow: 0 0 12px #0ECB81;
            animation: pulse 2s infinite;
        }

        .ws-info {
            color: #F0B90B;
            font-size: 13px;
            font-weight: 500;
        }

        .ws-stats {
            display: flex;
            gap: 20px;
            margin-left: auto;
        }

        .ws-stat {
            text-align: center;
        }

        .ws-stat-label {
            color: #A6B0C2;
            font-size: 11px;
            text-transform: uppercase;
        }

        .ws-stat-value {
            color: #F0B90B;
            font-weight: 600;
            font-size: 15px;
        }

        /* Trading Controls */
        .trading-controls {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            letter-spacing: 0.5px;
        }

        .control-btn.connect {
            background: #0ECB81;
            color: #0B0F1C;
        }

        .control-btn.disconnect {
            background: #F6465D;
            color: white;
        }

        .control-btn.market {
            background: #F0B90B;
            color: #0B0F1C;
        }

        .control-btn.orders {
            background: #8B5CF6;
            color: white;
        }

        /* Navigation */
        .nav {
            background: #1E2329;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 1px solid #2B3139;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            position: sticky;
            top: 20px;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .nav a {
            color: #A6B0C2;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav a:hover,
        .nav a.active {
            color: #F0B90B;
            background: #2B3139;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0 20px;
        }

        .section-header h2 {
            font-size: 22px;
            font-weight: 600;
            color: #F0B90B;
            border-left: 4px solid #F0B90B;
            padding-left: 15px;
            letter-spacing: 0.5px;
        }

        .section-header .version {
            background: #1E2329;
            color: #A6B0C2;
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 12px;
            border: 1px solid #2B3139;
        }

        /* Market Segments */
        .market-segments {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0 30px;
        }

        .segment-card {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .segment-card:hover {
            border-color: #F0B90B;
            transform: translateY(-2px);
        }

        .segment-card .name {
            color: #F0B90B;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .segment-card .desc {
            color: #A6B0C2;
            font-size: 11px;
        }

        /* Trading Grid */
        .trading-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Chart Container */
        .chart-container {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            padding: 20px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .symbol-info h1 {
            font-size: 28px;
            color: #F0B90B;
            margin: 0;
        }

        .symbol-info .company {
            font-size: 14px;
            color: #A6B0C2;
            margin-top: 2px;
        }

        .price-info {
            text-align: right;
        }

        .price-info .current {
            font-size: 32px;
            font-weight: 600;
            color: #0ECB81;
            display: block;
            transition: color 0.3s;
        }

        .price-info .current.up {
            color: #0ECB81;
            animation: flashGreen 0.5s;
        }

        .price-info .current.down {
            color: #F6465D;
            animation: flashRed 0.5s;
        }

        .price-info .change {
            font-size: 14px;
        }

        .price-info .change.positive {
            color: #0ECB81;
        }

        .price-info .change.negative {
            color: #F6465D;
        }

        /* Timeframe Selector */
        .timeframe-selector {
            display: flex;
            gap: 5px;
            margin: 15px 0;
            background: #2B3139;
            padding: 4px;
            border-radius: 8px;
            width: fit-content;
        }

        .timeframe-btn {
            background: transparent;
            border: none;
            color: #A6B0C2;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timeframe-btn:hover {
            color: #F0B90B;
        }

        .timeframe-btn.active {
            background: #F0B90B;
            color: #0B0F1C;
        }

        /* Chart Area */
        .chart-area {
            background: #2B3139;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            height: 300px;
            position: relative;
            border: 1px solid #3A3F4A;
            overflow: hidden;
        }

        .candlestick-chart {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            align-items: flex-end;
            gap: 2px;
        }

        .candle-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            height: 100%;
            position: relative;
            min-width: 8px;
        }

        .candle-body {
            width: 80%;
            border-radius: 2px;
            position: relative;
            transition: height 0.1s;
        }

        .candle-body.green {
            background: #0ECB81;
        }

        .candle-body.red {
            background: #F6465D;
        }

        .candle-wick {
            width: 2px;
            background: #A6B0C2;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .chart-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #A6B0C2;
            font-size: 11px;
        }

        /* Position Info */
        .position-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .position-item {
            background: #2B3139;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #3A3F4A;
        }

        .position-item.highlight {
            border-left: 3px solid #F0B90B;
        }

        .position-label {
            color: #A6B0C2;
            font-size: 11px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 4px;
        }

        .position-value {
            color: #E5E7EB;
            font-size: 13px;
            font-weight: 600;
            display: block;
        }

        .position-value.positive {
            color: #0ECB81;
        }

        .position-value.negative {
            color: #F6465D;
        }

        /* Trade Actions */
        .trade-actions {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .buy-btn, .sell-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .buy-btn {
            background: #0ECB81;
            color: #0B0F1C;
        }

        .sell-btn {
            background: #F6465D;
            color: white;
        }

        /* Order Book */
        .order-book {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            padding: 20px;
        }

        .order-book-header {
            display: flex;
            justify-content: space-between;
            color: #F0B90B;
            font-size: 12px;
            padding: 10px 0;
            border-bottom: 2px solid #2B3139;
            font-weight: 600;
        }

        .order-book-asks,
        .order-book-bids {
            max-height: 150px;
            overflow-y: auto;
        }

        .order-book-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 13px;
            font-family: monospace;
            transition: background 0.2s;
            position: relative;
        }

        .order-book-row:hover {
            background: #2B3139;
        }

        .volume-bar-container {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background: rgba(240, 185, 11, 0.1);
            z-index: 0;
            transition: width 0.3s;
        }

        .order-book-row span {
            position: relative;
            z-index: 1;
        }

        .bid-price {
            color: #0ECB81;
            font-weight: 600;
        }

        .ask-price {
            color: #F6465D;
            font-weight: 600;
        }

        .current-price-bar {
            background: #2B3139;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            border: 1px solid #F0B90B;
            font-weight: 600;
        }

        .bid-volume, .ask-volume {
            font-size: 11px;
            color: #A6B0C2;
        }

        .order-stats {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #2B3139;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #A6B0C2;
            font-size: 13px;
        }

        .stat-value {
            color: #F0B90B;
            font-weight: 600;
        }

        /* Spread Indicator */
        .spread-indicator {
            display: flex;
            justify-content: space-between;
            background: #2B3139;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 12px;
            color: #F0B90B;
        }

        /* Endpoint Card */
        .endpoint-card {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .endpoint-header {
            background: #2B3139;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid #3A3F4A;
        }

        .method {
            background: #F0B90B;
            color: #0B0F1C;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 13px;
        }

        .method.ws {
            background: #8B5CF6;
            color: white;
        }

        .endpoint-url {
            color: #F0B90B;
            font-family: monospace;
            font-size: 15px;
        }

        .endpoint-desc {
            color: #A6B0C2;
            font-size: 13px;
            margin-left: auto;
        }

        /* JSON Section */
        .json-section {
            padding: 20px;
            border-bottom: 1px solid #2B3139;
        }

        .json-title {
            color: #F0B90B;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .json-box {
            background: #2B3139;
            border: 1px solid #3A3F4A;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            font-family: monospace;
            font-size: 13px;
            color: #A6B0C2;
            position: relative;
            overflow-x: auto;
        }

        .json-box pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .json-box .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #1E2329;
            border: 1px solid #3A3F4A;
            color: #F0B90B;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .json-box .copy-btn:hover {
            border-color: #F0B90B;
            background: #2B3139;
        }

        /* Order Types Grid */
        .order-types-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .order-card {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            overflow: hidden;
        }

        .order-card:hover {
            border-color: #F0B90B;
        }

        .order-preview {
            padding: 20px;
            border-bottom: 1px solid #2B3139;
        }

        .preview-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 13px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2B3139;
        }

        .preview-row .value {
            color: #F0B90B;
            font-weight: 600;
        }

        .stock-info {
            text-align: center;
            margin: 15px 0;
        }

        .stock-symbol {
            font-size: 24px;
            font-weight: 600;
            color: #F0B90B;
        }

        .stock-name {
            font-size: 12px;
            color: #A6B0C2;
        }

        .bid-ask {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
            font-size: 12px;
            color: #A6B0C2;
        }

        .order-input {
            margin: 12px 0;
        }

        .order-input label {
            display: block;
            color: #A6B0C2;
            font-size: 11px;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .order-input input {
            width: 100%;
            background: #2B3139;
            border: 1px solid #3A3F4A;
            color: #E5E7EB;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            outline: none;
        }

        .order-input input:focus {
            border-color: #F0B90B;
        }

        .volume-slider {
            margin: 15px 0;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            color: #A6B0C2;
            font-size: 11px;
            margin-bottom: 5px;
        }

        .slider-track {
            height: 4px;
            background: #2B3139;
            border-radius: 2px;
            position: relative;
        }

        .slider-fill {
            height: 100%;
            width: 50%;
            background: #F0B90B;
            border-radius: 2px;
        }

        .order-note, .order-warning, .order-summary, .order-info, .order-requirement {
            font-size: 11px;
            padding: 8px 10px;
            border-radius: 6px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .order-note {
            background: rgba(240, 185, 11, 0.1);
            color: #F0B90B;
        }

        .order-warning {
            background: rgba(246, 70, 93, 0.1);
            color: #F6465D;
        }

        .order-summary {
            background: #2B3139;
            color: #A6B0C2;
        }

        .order-info {
            background: rgba(14, 203, 129, 0.1);
            color: #0ECB81;
        }

        .order-requirement {
            background: rgba(139, 92, 246, 0.1);
            color: #8B5CF6;
        }

        .confirm-btn {
            width: 100%;
            background: #F0B90B;
            color: #0B0F1C;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .confirm-btn:hover {
            background: #D6A50A;
        }

        .confirm-btn.large {
            padding: 15px;
            font-size: 16px;
        }

        /* Confirmation Card */
        .confirmation-details {
            background: #2B3139;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
        }

        .confirmation-header {
            color: #F0B90B;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
        }

        .confirmation-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #3A3F4A;
        }

        .confirmation-total {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px 0;
            border-top: 2px solid #F0B90B;
            font-weight: 600;
        }

        .confirmation-note {
            font-size: 11px;
            color: #A6B0C2;
            text-align: center;
            margin-top: 10px;
        }

        /* PIN Section */
        .pin-section {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            padding: 30px;
            max-width: 400px;
            margin: 30px auto;
        }

        .pin-header {
            color: #F0B90B;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 25px;
        }

        .pin-inputs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .pin-digit {
            width: 45px;
            height: 45px;
            background: #2B3139;
            border: 2px solid #3A3F4A;
            border-radius: 10px;
            color: #E5E7EB;
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            outline: none;
        }

        .pin-digit:focus {
            border-color: #F0B90B;
        }

        .pin-divider {
            text-align: center;
            color: #A6B0C2;
            font-size: 12px;
            margin: 15px 0;
            position: relative;
        }

        .pin-divider::before,
        .pin-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #2B3139;
        }

        .pin-divider::before {
            left: 0;
        }

        .pin-divider::after {
            right: 0;
        }

        .face-id-btn {
            width: 100%;
            background: #2B3139;
            border: 1px solid #F0B90B;
            color: #F0B90B;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .face-id-btn:hover {
            background: rgba(240, 185, 11, 0.1);
        }

        /* Market Data Grid */
        .market-data-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .data-card {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 12px;
            overflow: hidden;
        }

        .data-header {
            background: #2B3139;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #3A3F4A;
        }

        /* Holdings Section */
        .holdings-section {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .holdings-header {
            color: #F0B90B;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .holdings-list {
            max-height: 250px;
            overflow-y: auto;
        }

        .holding-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #2B3139;
            cursor: pointer;
        }

        .holding-item:hover {
            background: #2B3139;
        }

        .holding-symbol {
            color: #F0B90B;
            font-weight: 600;
        }

        .holding-price {
            color: #E5E7EB;
        }

        .holding-change.positive {
            color: #0ECB81;
        }

        .holding-change.negative {
            color: #F6465D;
        }

        .search-input {
            width: 100%;
            background: #2B3139;
            border: 1px solid #3A3F4A;
            color: #E5E7EB;
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            outline: none;
            margin-top: 15px;
        }

        .search-input:focus {
            border-color: #F0B90B;
        }

        /* WebSocket Console */
        .ws-console {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            margin: 20px 0;
            overflow: hidden;
        }

        .console-header {
            background: #2B3139;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #3A3F4A;
        }

        .console-header span {
            color: #F0B90B;
            font-weight: 600;
            font-size: 14px;
        }

        .clear-btn {
            background: transparent;
            border: 1px solid #3A3F4A;
            color: #A6B0C2;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .clear-btn:hover {
            border-color: #F0B90B;
            color: #F0B90B;
        }

        .console-messages {
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .console-message {
            padding: 8px;
            font-family: monospace;
            font-size: 12px;
            border-bottom: 1px solid #2B3139;
            color: #A6B0C2;
            animation: fadeIn 0.3s;
        }

        .console-message .msg-time {
            color: #F0B90B;
            margin-right: 10px;
        }

        .console-message .msg-type {
            color: #8B5CF6;
            margin-right: 10px;
            font-weight: 600;
        }

        .console-message .msg-data {
            color: #0ECB81;
        }

        .console-message .msg-data.ask {
            color: #F6465D;
        }

        .console-message .msg-data.bid {
            color: #0ECB81;
        }

        /* Real-time OHLC Stream Section */
        .realtime-streams {
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
        }

        .stream-header {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .stream-badge {
            background: #2B3139;
            color: #F0B90B;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes flashGreen {
            0%, 100% { color: #0ECB81; }
            50% { color: #FFFFFF; }
        }

        @keyframes flashRed {
            0%, 100% { color: #F6465D; }
            50% { color: #FFFFFF; }
        }

        /* Footer */
        .footer {
            margin-top: 50px;
            padding: 30px;
            background: #1E2329;
            border: 1px solid #2B3139;
            border-radius: 16px;
            text-align: center;
            color: #A6B0C2;
            font-size: 13px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .trading-grid {
                grid-template-columns: 1fr;
            }
            
            .order-types-grid {
                grid-template-columns: 1fr;
            }
            
            .market-data-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>OPTIMUS CAPITAL TRADING PLATFORM</h1>
            <div class="subtitle">Pakistan Stock Exchange (PSX) - Complete Trading API Documentation for Vision Max Integration</div>
            <div class="badge">Version 1.0 | All POST | Real-Time WebSocket</div>
        </div>

        <!-- WebSocket Status -->
        <div class="ws-status">
            <div class="ws-indicator">
                <div class="ws-led connected" id="wsLed"></div>
                <span id="wsStatus">WEBSOCKET CONNECTED</span>
            </div>
            <div class="ws-info">Session: OPTIMUS_TRADING_001 | Market: PSX</div>
            <div class="ws-stats">
                <div class="ws-stat">
                    <div class="ws-stat-label">LATENCY</div>
                    <div class="ws-stat-value" id="wsLatency">12ms</div>
                </div>
                <div class="ws-stat">
                    <div class="ws-stat-label">SYMBOLS</div>
                    <div class="ws-stat-value">540</div>
                </div>
                <div class="ws-stat">
                    <div class="ws-stat-label">TICKS/SEC</div>
                    <div class="ws-stat-value" id="tickRate">24</div>
                </div>
            </div>
        </div>

        <!-- Trading Controls -->
        <div class="trading-controls">
            <button class="control-btn connect" onclick="connectWebSocket()">üîå CONNECT</button>
            <button class="control-btn disconnect" onclick="disconnectWebSocket()">‚ö° DISCONNECT</button>
            <button class="control-btn market" onclick="subscribeMarket()">üì° MARKET DATA</button>
            <button class="control-btn orders" onclick="subscribeOrders()">üì¶ ORDER UPDATES</button>
        </div>

        <!-- Navigation -->
        <div class="nav">
            <a href="#trading" class="active">TRADING</a>
            <a href="#orders">ORDER TYPES</a>
            <a href="#market-data">MARKET DATA</a>
            <a href="#holdings">HOLDINGS</a>
            <a href="#websocket">WEBSOCKET</a>
        </div>

        <!-- Market Segments -->
        <div class="market-segments">
            <div class="segment-card"><div class="name">KSE 100</div><div class="desc">100 Largest companies</div></div>
            <div class="segment-card"><div class="name">KSE 30</div><div class="desc">Top 30 Liquid</div></div>
            <div class="segment-card"><div class="name">KMI 30</div><div class="desc">Shariah Compliant</div></div>
            <div class="segment-card"><div class="name">KSE ALL</div><div class="desc">All Companies</div></div>
            <div class="segment-card"><div class="name">KMI ALL</div><div class="desc">All Shariah</div></div>
            <div class="segment-card"><div class="name">PSXDIV20</div><div class="desc">Dividend Paying</div></div>
        </div>

        <!-- Trading View -->
        <div class="section-header" id="trading">
            <h2>TRADING INTERFACE</h2>
            <div class="version">MEBL - Meezan Bank Ltd</div>
        </div>

        <div class="trading-grid">
            <!-- Chart Column -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="symbol-info">
                        <h1>MEBL</h1>
                        <div class="company">Meezan Bank Limited</div>
                    </div>
                    <div class="price-info">
                        <span class="current" id="currentPrice">112,539.17</span>
                        <span class="change positive" id="priceChange">‚ñ≤ 0.25 (1.01%)</span>
                    </div>
                </div>

                <!-- Timeframe Selector -->
                <div class="timeframe-selector">
                    <button class="timeframe-btn" onclick="changeInterval('1m')">1m</button>
                    <button class="timeframe-btn" onclick="changeInterval('5m')">5m</button>
                    <button class="timeframe-btn active" onclick="changeInterval('15m')">15m</button>
                    <button class="timeframe-btn" onclick="changeInterval('30m')">30m</button>
                    <button class="timeframe-btn" onclick="changeInterval('1h')">1h</button>
                    <button class="timeframe-btn" onclick="changeInterval('1d')">1d</button>
                </div>

                <!-- Chart Area -->
                <div class="chart-area">
                    <div class="candlestick-chart" id="candleChart"></div>
                    <div class="chart-labels">
                        <span>09:30</span>
                        <span>10:00</span>
                        <span>10:30</span>
                        <span>11:00</span>
                        <span>11:30</span>
                        <span>12:00</span>
                        <span>12:30</span>
                        <span>13:00</span>
                        <span>13:30</span>
                        <span>14:00</span>
                        <span>14:30</span>
                        <span>15:00</span>
                    </div>
                </div>

                <!-- Position Info -->
                <div class="position-info">
                    <div class="position-item">
                        <span class="position-label">Shares</span>
                        <span class="position-value">15</span>
                    </div>
                    <div class="position-item">
                        <span class="position-label">Market value</span>
                        <span class="position-value">PKR 280.35</span>
                    </div>
                    <div class="position-item">
                        <span class="position-label">Average cost</span>
                        <span class="position-value">PKR 96.16</span>
                    </div>
                    <div class="position-item">
                        <span class="position-label">Portfolio diversity</span>
                        <span class="position-value">22.16%</span>
                    </div>
                    <div class="position-item highlight">
                        <span class="position-label">Today's return</span>
                        <span class="position-value positive" id="todayReturn">+PKR 4.05 (+1.47%)</span>
                    </div>
                    <div class="position-item highlight">
                        <span class="position-label">Total return</span>
                        <span class="position-value positive" id="totalReturn">+PKR 1162.05 (+80.56%)</span>
                    </div>
                </div>

                <!-- Buy/Sell Buttons -->
                <div class="trade-actions">
                    <button class="buy-btn" onclick="openBuyOrder()">BUY</button>
                    <button class="sell-btn" onclick="openSellOrder()">SELL</button>
                </div>
            </div>

            <!-- Order Book Column -->
            <div class="order-book">
                <div class="order-book-header">
                    <span>Price (PKR)</span>
                    <span>Size</span>
                    <span>Value</span>
                </div>
                
                <!-- Asks -->
                <div class="order-book-asks" id="orderBookAsks"></div>
                
                <!-- Current Price -->
                <div class="current-price-bar" id="currentPriceBar">
                    <span class="bid-price" id="bestBid">18.61</span>
                    <span id="spread">0.00 (0.00%)</span>
                    <span class="ask-price" id="bestAsk">18.61</span>
                </div>
                
                <!-- Bids -->
                <div class="order-book-bids" id="orderBookBids"></div>
                
                <!-- Spread Indicator -->
                <div class="spread-indicator">
                    <span>Spread</span>
                    <span id="spreadValue">0.00 (0.00%)</span>
                </div>
                
                <!-- Stats -->
                <div class="order-stats">
                    <div class="stat-row"><span>Open</span><span class="stat-value" id="dailyOpen">112,539.17</span></div>
                    <div class="stat-row"><span>High</span><span class="stat-value" id="dailyHigh">113,200.00</span></div>
                    <div class="stat-row"><span>Low</span><span class="stat-value" id="dailyLow">112,100.00</span></div>
                    <div class="stat-row"><span>Volume</span><span class="stat-value" id="dailyVolume">4,123,123</span></div>
                    <div class="stat-row"><span>Total Bid Vol</span><span class="stat-value" id="totalBidVol">4,530</span></div>
                    <div class="stat-row"><span>Total Ask Vol</span><span class="stat-value" id="totalAskVol">675</span></div>
                </div>
            </div>
        </div>

        <!-- WebSocket Market Data Streams (Section 2) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>2. WEBSOCKET MARKET DATA STREAMS</h2>
                <div class="version">Real-Time ¬∑ JWT Required</div>
            </div>
            
            <!-- 2.1 General Connection -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">wss://md.optimuscapital.com/ws?token={jwt_token}</span>
                <span class="endpoint-desc">General Connection</span>
            </div>
            
            <!-- 2.2 Market Watch -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">market_watch</span>
                <span class="endpoint-desc">Top-level data stream</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('market-watch-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "market_watch",
  "symbols": ["MEBL", "SYS", "ENGRO", "OGDC"],
  "client_id": "user_12345"
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('market-watch-update')">Copy</button>
                    <pre>{
  "stream": "market_watch",
  "timestamp": "2024-05-20T10:15:30.123Z",
  "data": [
    {
      "symbol": "MEBL",
      "symbol_name": "Meezan Bank Ltd",
      "last_trade_price": 187.50,
      "change": 2.30,
      "change_percent": 1.24,
      "volume": 1520000,
      "high_24h": 188.00,
      "low_24h": 185.10,
      "open_price": 185.50,
      "close_price": 185.20,
      "status": "T"
    }
  ]
}</pre>
                </div>
                
                <div class="json-title">‚ö†Ô∏è Error</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('market-watch-error')">Copy</button>
                    <pre>{
  "stream": "market_watch",
  "error": {
    "code": 4001,
    "message": "Invalid symbol list provided."
  }
}</pre>
                </div>
            </div>
            
            <!-- 2.3 Symbol Detail -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">symbol_detail</span>
                <span class="endpoint-desc">Detailed symbol information</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('symbol-detail-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "symbol_detail",
  "symbol": "MEBL"
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('symbol-detail-update')">Copy</button>
                    <pre>{
  "stream": "symbol_detail",
  "symbol": "MEBL",
  "timestamp": "2024-05-20T10:15:31.456Z",
  "data": {
    "company_name": "Meezan Bank Ltd",
    "sector": "Commercial Banks",
    "ltp": 187.50,
    "change": 2.30,
    "change_percent": 1.24,
    "open": 185.20,
    "high": 188.00,
    "low": 185.10,
    "close": 185.20,
    "volume": 1520000,
    "turnover": 284050000.50,
    "market_cap": 375000000000,
    "pe_ratio": 6.50,
    "dividend_yield": 8.5,
    "upper_circuit": 203.72,
    "lower_circuit": 166.68,
    "bid": 187.00,
    "bid_volume": 1500,
    "ask": 187.60,
    "ask_volume": 800
  }
}</pre>
                </div>
            </div>
            
            <!-- 2.4 Order Book -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">order_book</span>
                <span class="endpoint-desc">Market depth - Level 2</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('order-book-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "order_book",
  "symbol": "MEBL",
  "depth": 10
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('order-book-update')">Copy</button>
                    <pre>{
  "stream": "order_book",
  "symbol": "MEBL",
  "timestamp": "2024-05-20T10:15:32.789Z",
  "data": {
    "bids": [
      {"price": 187.50, "volume": 10500, "orders": 5},
      {"price": 187.40, "volume": 8000, "orders": 3}
    ],
    "asks": [
      {"price": 187.60, "volume": 7200, "orders": 4},
      {"price": 187.70, "volume": 12500, "orders": 7}
    ],
    "sequence": 123456789
  }
}</pre>
                </div>
            </div>
            
            <!-- 2.5 Trade Tape -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">trade_tape</span>
                <span class="endpoint-desc">Recent trades</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('trade-tape-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "trade_tape",
  "symbol": "MEBL"
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('trade-tape-update')">Copy</button>
                    <pre>{
  "stream": "trade_tape",
  "symbol": "MEBL",
  "timestamp": "2024-05-20T10:15:33.012Z",
  "data": {
    "trade_id": "1098765",
    "price": 187.50,
    "volume": 500,
    "value": 93750,
    "trade_time": "2024-05-20T10:15:32.500Z",
    "buyer_broker": "127",
    "seller_broker": "56"
  }
}</pre>
                </div>
            </div>
            
            <!-- 2.6 OHLC Candle -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">ohlc</span>
                <span class="endpoint-desc">Candlestick data</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('ohlc-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "ohlc",
  "symbol": "MEBL",
  "interval": "1m"
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('ohlc-update')">Copy</button>
                    <pre>{
  "stream": "ohlc",
  "symbol": "MEBL",
  "interval": "1m",
  "timestamp": "2024-05-20T10:16:00.000Z",
  "data": {
    "open": 187.20,
    "high": 187.60,
    "low": 187.15,
    "close": 187.50,
    "volume": 85000
  }
}</pre>
                </div>
            </div>
            
            <!-- 2.7 Index -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">index</span>
                <span class="endpoint-desc">Market indices</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('index-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "index",
  "indices": ["KSE100", "KSE30", "KMI30"]
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('index-update')">Copy</button>
                    <pre>{
  "stream": "index",
  "timestamp": "2024-05-20T10:15:35.500Z",
  "data": [
    {
      "index_code": "KSE100",
      "index_name": "KSE-100 Index",
      "value": 67890.12,
      "change": 120.45,
      "change_percent": 0.18,
      "high": 67950.00,
      "low": 67700.00,
      "volume": 15000000
    }
  ]
}</pre>
                </div>
            </div>
            
            <!-- 2.8 Market Status -->
            <div class="endpoint-header">
                <span class="method ws">WS</span>
                <span class="endpoint-url">market_status</span>
                <span class="endpoint-desc">Market status</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Subscribe</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('market-status-sub')">Copy</button>
                    <pre>{
  "action": "subscribe",
  "stream": "market_status"
}</pre>
                </div>
                
                <div class="json-title">üì• Update</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('market-status-update')">Copy</button>
                    <pre>{
  "stream": "market_status",
  "timestamp": "2024-05-20T09:30:00.000Z",
  "data": {
    "status": "open",
    "message": "Regular Trading Session",
    "next_status_change": "2024-05-20T15:30:00+05:00"
  }
}</pre>
                </div>
            </div>
        </div>

        <!-- REST APIs Section (Section 3) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>3. TRADING REST APIS</h2>
                <div class="version">Base: https://api.optimuscapital.com/v1</div>
            </div>
            
            <!-- 3.1 Authentication -->
            <div class="endpoint-header">
                <span class="method">POST</span>
                <span class="endpoint-url">/auth/login</span>
                <span class="endpoint-desc">User authentication</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Request</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('login-req')">Copy</button>
                    <pre>{
  "login_id": "user@email.com",
  "password": "user_password",
  "device_id": "unique_device_fingerprint",
  "device_type": "mobile"
}</pre>
                </div>
                
                <div class="json-title">üì• Success (200)</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('login-res')">Copy</button>
                    <pre>{
  "status": "success",
  "code": 200,
  "message": "Authentication successful.",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIs...",
    "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg==",
    "token_type": "Bearer",
    "expires_in": 3600,
    "user": {
      "user_id": "12345",
      "full_name": "Alex Peter",
      "email": "alexpeter@gmail.com",
      "account_status": "active",
      "kyc_status": "approved"
    }
  },
  "request_id": "req-123e4567-e89b-12d3-a456-426614174000"
}</pre>
                </div>
                
                <div class="json-title">‚ö†Ô∏è Error (401)</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('login-error')">Copy</button>
                    <pre>{
  "status": "error",
  "code": 401,
  "message": "Invalid login credentials or account locked.",
  "error_details": {
    "reason": "invalid_password",
    "attempts_remaining": 2
  },
  "request_id": "req-123e4567-e89b-12d3-a456-426614174001"
}</pre>
                </div>
            </div>
            
            <div class="endpoint-header">
                <span class="method">POST</span>
                <span class="endpoint-url">/auth/refresh</span>
                <span class="endpoint-desc">Refresh token</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Request</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('refresh-req')">Copy</button>
                    <pre>{
  "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg=="
}</pre>
                </div>
                
                <div class="json-title">üì• Response</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('refresh-res')">Copy</button>
                    <pre>{
  "status": "success",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIs...",
    "expires_in": 3600
  },
  "request_id": "req-123e4567-e89b-12d3-a456-426614174002"
}</pre>
                </div>
            </div>
            
            <div class="endpoint-header">
                <span class="method">POST</span>
                <span class="endpoint-url">/auth/logout</span>
                <span class="endpoint-desc">Logout</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Request</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('logout-req')">Copy</button>
                    <pre>{
  "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg=="
}</pre>
                </div>
                
                <div class="json-title">üì• Response</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('logout-res')">Copy</button>
                    <pre>{
  "status": "success",
  "code": 200,
  "message": "Successfully logged out.",
  "request_id": "req-123e4567-e89b-12d3-a456-426614174003"
}</pre>
                </div>
            </div>
            
            <!-- 3.2 Place Order -->
            <div class="endpoint-header">
                <span class="method">POST</span>
                <span class="endpoint-url">/orders</span>
                <span class="endpoint-desc">Place order (Idempotency-Key required)</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Request</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('order-req')">Copy</button>
                    <pre>{
  "symbol": "MEBL",
  "side": "buy",
  "order_type": "limit",
  "quantity": 500,
  "price": 187.50,
  "trigger_price": 185.00,
  "time_in_force": "day",
  "display_quantity": 100,
  "client_order_id": "my_order_ref_123"
}</pre>
                </div>
                
                <div class="json-title">üì• Success (202)</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('order-res')">Copy</button>
                    <pre>{
  "status": "accepted",
  "code": 202,
  "message": "Order placed successfully and sent to exchange.",
  "data": {
    "order_id": "ODR123456789",
    "client_order_id": "my_order_ref_123",
    "symbol": "MEBL",
    "side": "buy",
    "order_type": "limit",
    "quantity": 500,
    "price": 187.50,
    "status": "pending",
    "reject_reason": null,
    "order_time": "2024-05-20T10:20:00.123Z"
  },
  "request_id": "req-123e4567-e89b-12d3-a456-426614174004"
}</pre>
                </div>
                
                <div class="json-title">‚ö†Ô∏è Error (400)</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('order-error')">Copy</button>
                    <pre>{
  "status": "error",
  "code": 400,
  "message": "Order validation failed.",
  "error_details": {
    "field": "quantity",
    "reason": "Invalid lot size. Must be a multiple of 500."
  },
  "request_id": "req-123e4567-e89b-12d3-a456-426614174005"
}</pre>
                </div>
            </div>
            
            <!-- 3.3 Portfolio APIs -->
            <div class="endpoint-header">
                <span class="method">GET</span>
                <span class="endpoint-url">/portfolio/summary</span>
                <span class="endpoint-desc">Portfolio summary</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì• Response</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('portfolio-summary')">Copy</button>
                    <pre>{
  "status": "success",
  "data": {
    "total_investment": 1250000.00,
    "current_value": 1320000.00,
    "total_pnl": 70000.00,
    "total_pnl_percent": 5.6,
    "day_change": 2500.00,
    "day_change_percent": 0.19
  },
  "request_id": "..."
}</pre>
                </div>
            </div>
            
            <div class="endpoint-header">
                <span class="method">GET</span>
                <span class="endpoint-url">/portfolio/holdings</span>
                <span class="endpoint-desc">Holdings</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì• Response</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('holdings-res')">Copy</button>
                    <pre>{
  "status": "success",
  "data": {
    "holdings": [
      {
        "symbol": "MEBL",
        "quantity": 1000,
        "average_price": 180.50,
        "ltp": 187.50,
        "current_value": 187500,
        "unrealized_pnl": 7000,
        "unrealized_pnl_percent": 3.88,
        "day_change": 100,
        "day_change_percent": 0.05
      }
    ]
  },
  "request_id": "..."
}</pre>
                </div>
            </div>
            
            <div class="endpoint-header">
                <span class="method">GET</span>
                <span class="endpoint-url">/account/buying-power</span>
                <span class="endpoint-desc">Buying power</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì• Response</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('buying-power')">Copy</button>
                    <pre>{
  "status": "success",
  "data": {
    "net_equity": 1500000.00,
    "cash_balance": 250000.00,
    "available_margin": 1250000.00,
    "used_margin": 250000.00,
    "maintenance_margin": 75000.00
  },
  "request_id": "..."
}</pre>
                </div>
            </div>
        </div>

        <!-- Notification Webhook Section (Section 4) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>4. NOTIFICATION WEBHOOK</h2>
                <div class="version">Vision Max ‚Üí Optimus</div>
            </div>
            
            <div class="endpoint-header">
                <span class="method">POST</span>
                <span class="endpoint-url">https://notifications.optimuscapital.com/webhook/visionmax</span>
                <span class="endpoint-desc">IP Whitelist / X-API-Key</span>
            </div>
            
            <div class="json-section">
                <div class="json-title">üì§ Webhook Payload</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('webhook')">Copy</button>
                    <pre>{
  "event_id": "evt_abc123def",
  "event_type": "order.execution",
  "timestamp": "2024-05-20T10:21:00.000Z",
  "data": {
    "user_id": "12345",
    "order_id": "ODR123456789",
    "execution_details": {
      "execution_id": "EXE987654",
      "executed_quantity": 200,
      "executed_price": 187.50,
      "execution_time": "2024-05-20T10:20:59.500Z",
      "remaining_quantity": 300,
      "order_status": "partially_filled"
    },
    "reject_details": {
      "reason_code": "INSUFFICIENT_BALANCE",
      "reason_message": "Buying power check failed."
    }
  },
  "version": "1.0"
}</pre>
                </div>
                
                <div class="json-title">üì• Acknowledgement</div>
                <div class="json-box">
                    <button class="copy-btn" onclick="copyJson('webhook-ack')">Copy</button>
                    <pre>{
  "status": "received",
  "event_id": "evt_abc123def"
}</pre>
                </div>
                
                <div class="json-title">üìã Event Types</div>
                <div class="json-box">
                    <pre>order.confirmed  - Order accepted by exchange
order.rejected   - Order rejected by pre-trade checks or exchange
order.cancelled  - Order cancelled by user
order.execution  - Partial or full fill
margin.call      - Margin call threshold hit
account.alert    - Deposit confirmation, withdrawal status</pre>
                </div>
                
                <div class="json-title">üîÑ Retry Mechanism</div>
                <div class="json-box">
                    <pre>If no 2xx response within 5 seconds:
Retry: 1s, 5s, 30s, 5m, 30m ... up to 24 hours</pre>
                </div>
            </div>
        </div>

        <!-- PSX Considerations Section (Section 5) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>5. PSX-SPECIFIC CONSIDERATIONS</h2>
                <div class="version">Pakistan Stock Exchange</div>
            </div>
            
            <div class="json-section">
                <div class="json-box">
                    <pre>‚Ä¢ T+2 Settlement: All cash and security balances reflect T+2 cycle
‚Ä¢ Market Timings:
  - Pre-open Session: 9:15 AM ‚Äì 9:30 AM
  - Continuous Trading: 9:30 AM ‚Äì 3:30 PM
  - Post-close Session: 3:30 PM ‚Äì 3:35 PM (market orders only)
‚Ä¢ Circuit Breakers: Upper/lower locks must be respected
‚Ä¢ Lot Size: Orders must be in multiples of lot size
‚Ä¢ Short Selling: Not permitted for retail investors
‚Ä¢ Order Types: MIT (Market If Touched), MTL (Market To Limit), IOC, FOK</pre>
                </div>
            </div>
        </div>

        <!-- Security & Compliance Section (Section 6) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>6. SECURITY & COMPLIANCE</h2>
                <div class="version">TLS 1.2+ Required</div>
            </div>
            
            <div class="json-section">
                <div class="json-box">
                    <pre>‚Ä¢ Encryption: TLS 1.2+ (HTTPS for REST, WSS for WebSockets)
‚Ä¢ Rate Limiting:
  - Authentication APIs: 5 requests per minute per IP
  - Trading APIs: 100 requests per second per user
  - Public Data APIs: 200 requests per minute per IP
  - Headers: X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset
‚Ä¢ IP Whitelisting: Vision Max whitelists Optimus production IPs
‚Ä¢ Audit Logs: All orders/auth logged with request_id, user_id, timestamp
‚Ä¢ Data Sensitivity: PII encrypted at rest, CNIC never logged in plaintext</pre>
                </div>
            </div>
        </div>

        <!-- JSON Standards Section (Section 7) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>7. JSON STANDARDS</h2>
                <div class="version">snake_case ¬∑ ISO 8601</div>
            </div>
            
            <div class="json-section">
                <div class="json-box">
                    <pre>‚Ä¢ Naming Convention: snake_case for all JSON property names
‚Ä¢ Timestamps: ISO 8601 format (YYYY-MM-DDTHH:mm:ss.sssZ)
‚Ä¢ Numbers: Use JSON number type (not strings)
‚Ä¢ Unique Request ID: Every response includes request_id
‚Ä¢ Standard Response Envelope:
  Success: { "status": "success", "code": 200, "data": { ... }, "request_id": "..." }
  Error:   { "status": "error", "code": 400, "message": "Summary", "error_details": { ... }, "request_id": "..." }</pre>
                </div>
            </div>
        </div>

        <!-- Error Codes Section (Section 8) -->
        <div class="realtime-streams">
            <div class="section-header">
                <h2>8. ERROR CODES</h2>
                <div class="version">Complete Reference</div>
            </div>
            
            <div class="json-section">
                <div class="json-box">
                    <pre>1001 Authentication - Invalid token - Re-authenticate
1002 Authentication - Token expired - Use refresh token
1003 Authorization - Insufficient permissions - Contact support
2001 Trading - Invalid symbol - Check symbol list
2002 Trading - Invalid quantity (lot size) - Adjust quantity
2003 Trading - Invalid price (outside circuit breaker) - Adjust price
2004 Trading - Insufficient buying power - Deposit funds
2005 Trading - Position not held (for sell orders) - Check holdings
2006 Trading - Market closed - Trade during market hours
2007 Trading - Order type not supported - Use another order type
3001 System - Rate limit exceeded - Slow down requests
3002 System - Idempotency key reused - Generate a new key
9001 Vision Max - Backend connectivity issue - Try again later</pre>
                </div>
            </div>
        </div>

        <!-- PIN Authentication -->
        <div class="pin-section">
            <div class="pin-header">Enter Your PIN</div>
            <div class="pin-inputs">
                <input type="password" maxlength="1" class="pin-digit" id="pin1">
                <input type="password" maxlength="1" class="pin-digit" id="pin2">
                <input type="password" maxlength="1" class="pin-digit" id="pin3">
                <input type="password" maxlength="1" class="pin-digit" id="pin4">
                <input type="password" maxlength="1" class="pin-digit" id="pin5">
                <input type="password" maxlength="1" class="pin-digit" id="pin6">
            </div>
            <div class="pin-divider">Or</div>
            <button class="face-id-btn">Authenticate Using Face ID</button>
        </div>

        <!-- Holdings Section -->
        <div class="section-header" id="holdings">
            <h2>YOUR HOLDINGS</h2>
            <div class="version">Portfolio Summary</div>
        </div>

        <div class="holdings-section">
            <div class="holdings-header">Your Holdings</div>
            <div class="holdings-list">
                <div class="holding-item">
                    <span class="holding-symbol">MEBL</span>
                    <span class="holding-price">PKR 187.50</span>
                    <span class="holding-change positive">+1.24%</span>
                </div>
                <div class="holding-item">
                    <span class="holding-symbol">SYS</span>
                    <span class="holding-price">PKR 432.10</span>
                    <span class="holding-change positive">+0.58%</span>
                </div>
                <div class="holding-item">
                    <span class="holding-symbol">ENGRO</span>
                    <span class="holding-price">PKR 321.75</span>
                    <span class="holding-change positive">+2.10%</span>
                </div>
                <div class="holding-item">
                    <span class="holding-symbol">OGDC</span>
                    <span class="holding-price">PKR 109.30</span>
                    <span class="holding-change positive">+0.92%</span>
                </div>
                <div class="holding-item">
                    <span class="holding-symbol">PSO</span>
                    <span class="holding-price">PKR 75.12</span>
                    <span class="holding-change positive">+1.61%</span>
                </div>
                <div class="holding-item">
                    <span class="holding-symbol">KEL</span>
                    <span class="holding-price">PKR 102.50</span>
                    <span class="holding-change negative">-1.06%</span>
                </div>
            </div>
            <input type="text" class="search-input" placeholder="Q Search Symbol">
        </div>

        <!-- WebSocket Console -->
        <div class="section-header" id="websocket">
            <h2>WEBSOCKET CONSOLE</h2>
            <div class="version">Live Trading Updates</div>
        </div>

        <div class="ws-console">
            <div class="console-header">
                <span>Live Messages <span id="messageCount" style="color: #F0B90B; margin-left: 10px;">(12)</span></span>
                <button class="clear-btn" onclick="clearConsole()">Clear</button>
            </div>
            <div class="console-messages" id="wsMessages">
                <div class="console-message">
                    <span class="msg-time">[11:30:00]</span>
                    <span class="msg-type">SYSTEM</span>
                    <span class="msg-data">WebSocket connected - Session ID: ws_optimus_001</span>
                </div>
                <div class="console-message">
                    <span class="msg-time">[11:30:01]</span>
                    <span class="msg-type">MARKET</span>
                    <span class="msg-data">Subscribed to MEBL, SYS, ENGRO, OGDC</span>
                </div>
                <div class="console-message">
                    <span class="msg-time">[11:30:02]</span>
                    <span class="msg-type">TRADE</span>
                    <span class="msg-data">MEBL: 187.50 (5,000 shares)</span>
                </div>
                <div class="console-message">
                    <span class="msg-time">[11:30:03]</span>
                    <span class="msg-type">QUOTE</span>
                    <span class="msg-data">MEBL Bid: 187.00 (1500) | Ask: 187.60 (800)</span>
                </div>
                <div class="console-message">
                    <span class="msg-time">[11:30:04]</span>
                    <span class="msg-type">ORDER</span>
                    <span class="msg-data">Limit order ODR1234567890 accepted</span>
                </div>
                <div class="console-message">
                    <span class="msg-time">[11:30:05]</span>
                    <span class="msg-type">DEPTH</span>
                    <span class="msg-data">MEBL Depth: Bids 18500 | Asks 19700</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Optimus Capital Trading Platform v1.0 | Pakistan Stock Exchange (PSX) Integration for Vision Max</p>
            <p>¬© 2026 Optimus Capital. All rights reserved. | All endpoints use POST where specified | Complete Request/Response JSON</p>
        </div>
    </div>

    <script>
        // WebSocket State
        let wsConnected = true;
        let messageCount = 0;
        let currentInterval = '15m';
        let basePrice = 187.50;
        let lastBid = 187.00;
        let lastAsk = 187.60;

        // WebSocket Functions
        function connectWebSocket() {
            wsConnected = true;
            document.getElementById('wsLed').className = 'ws-led connected';
            document.getElementById('wsStatus').textContent = 'WEBSOCKET CONNECTED';
            addConsoleMessage('SYSTEM', 'WebSocket connected - Session ID: ws_optimus_' + Date.now());
        }

        function disconnectWebSocket() {
            wsConnected = false;
            document.getElementById('wsLed').className = 'ws-led';
            document.getElementById('wsStatus').textContent = 'WEBSOCKET DISCONNECTED';
            addConsoleMessage('SYSTEM', 'WebSocket disconnected');
        }

        function subscribeMarket() {
            addConsoleMessage('MARKET', 'Subscribed to MEBL, SYS, ENGRO, OGDC');
        }

        function subscribeOrders() {
            addConsoleMessage('ORDERS', 'Subscribed to order updates for account A12345678');
        }

        function addConsoleMessage(type, data) {
            const container = document.getElementById('wsMessages');
            if (!container) return;
            
            const now = new Date();
            const timeStr = `[${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}]`;
            
            const msgDiv = document.createElement('div');
            msgDiv.className = 'console-message';
            msgDiv.innerHTML = `
                <span class="msg-time">${timeStr}</span>
                <span class="msg-type">${type}</span>
                <span class="msg-data">${data}</span>
            `;
            
            container.insertBefore(msgDiv, container.firstChild);
            
            messageCount++;
            document.getElementById('messageCount').textContent = `(${messageCount})`;
            
            while (container.children.length > 20) {
                container.removeChild(container.lastChild);
            }
        }

        function clearConsole() {
            document.getElementById('wsMessages').innerHTML = '';
            messageCount = 0;
            document.getElementById('messageCount').textContent = '(0)';
            addConsoleMessage('SYSTEM', 'Console cleared');
        }

        function changeInterval(interval) {
            currentInterval = interval;
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === interval) {
                    btn.classList.add('active');
                }
            });
            addConsoleMessage('CHART', `Interval changed to ${interval}`);
            generateCandles();
        }

        function openBuyOrder() {
            addConsoleMessage('TRADE', 'Buy order panel opened for MEBL');
            document.getElementById('orders').scrollIntoView({ behavior: 'smooth' });
        }

        function openSellOrder() {
            addConsoleMessage('TRADE', 'Sell order panel opened for MEBL');
            document.getElementById('orders').scrollIntoView({ behavior: 'smooth' });
        }

        // Copy JSON function
        function copyJson(type) {
            const jsons = {
                'market-watch-sub': '{\n  "action": "subscribe",\n  "stream": "market_watch",\n  "symbols": ["MEBL", "SYS", "ENGRO", "OGDC"],\n  "client_id": "user_12345"\n}',
                'market-watch-update': '{\n  "stream": "market_watch",\n  "timestamp": "2024-05-20T10:15:30.123Z",\n  "data": [\n    {\n      "symbol": "MEBL",\n      "symbol_name": "Meezan Bank Ltd",\n      "last_trade_price": 187.50,\n      "change": 2.30,\n      "change_percent": 1.24,\n      "volume": 1520000,\n      "high_24h": 188.00,\n      "low_24h": 185.10,\n      "open_price": 185.50,\n      "close_price": 185.20,\n      "status": "T"\n    }\n  ]\n}',
                'market-watch-error': '{\n  "stream": "market_watch",\n  "error": {\n    "code": 4001,\n    "message": "Invalid symbol list provided."\n  }\n}',
                'symbol-detail-sub': '{\n  "action": "subscribe",\n  "stream": "symbol_detail",\n  "symbol": "MEBL"\n}',
                'symbol-detail-update': '{\n  "stream": "symbol_detail",\n  "symbol": "MEBL",\n  "timestamp": "2024-05-20T10:15:31.456Z",\n  "data": {\n    "company_name": "Meezan Bank Ltd",\n    "sector": "Commercial Banks",\n    "ltp": 187.50,\n    "change": 2.30,\n    "change_percent": 1.24,\n    "open": 185.20,\n    "high": 188.00,\n    "low": 185.10,\n    "close": 185.20,\n    "volume": 1520000,\n    "turnover": 284050000.50,\n    "market_cap": 375000000000,\n    "pe_ratio": 6.50,\n    "dividend_yield": 8.5,\n    "upper_circuit": 203.72,\n    "lower_circuit": 166.68,\n    "bid": 187.00,\n    "bid_volume": 1500,\n    "ask": 187.60,\n    "ask_volume": 800\n  }\n}',
                'order-book-sub': '{\n  "action": "subscribe",\n  "stream": "order_book",\n  "symbol": "MEBL",\n  "depth": 10\n}',
                'order-book-update': '{\n  "stream": "order_book",\n  "symbol": "MEBL",\n  "timestamp": "2024-05-20T10:15:32.789Z",\n  "data": {\n    "bids": [\n      {"price": 187.50, "volume": 10500, "orders": 5},\n      {"price": 187.40, "volume": 8000, "orders": 3}\n    ],\n    "asks": [\n      {"price": 187.60, "volume": 7200, "orders": 4},\n      {"price": 187.70, "volume": 12500, "orders": 7}\n    ],\n    "sequence": 123456789\n  }\n}',
                'trade-tape-sub': '{\n  "action": "subscribe",\n  "stream": "trade_tape",\n  "symbol": "MEBL"\n}',
                'trade-tape-update': '{\n  "stream": "trade_tape",\n  "symbol": "MEBL",\n  "timestamp": "2024-05-20T10:15:33.012Z",\n  "data": {\n    "trade_id": "1098765",\n    "price": 187.50,\n    "volume": 500,\n    "value": 93750,\n    "trade_time": "2024-05-20T10:15:32.500Z",\n    "buyer_broker": "127",\n    "seller_broker": "56"\n  }\n}',
                'ohlc-sub': '{\n  "action": "subscribe",\n  "stream": "ohlc",\n  "symbol": "MEBL",\n  "interval": "1m"\n}',
                'ohlc-update': '{\n  "stream": "ohlc",\n  "symbol": "MEBL",\n  "interval": "1m",\n  "timestamp": "2024-05-20T10:16:00.000Z",\n  "data": {\n    "open": 187.20,\n    "high": 187.60,\n    "low": 187.15,\n    "close": 187.50,\n    "volume": 85000\n  }\n}',
                'index-sub': '{\n  "action": "subscribe",\n  "stream": "index",\n  "indices": ["KSE100", "KSE30", "KMI30"]\n}',
                'index-update': '{\n  "stream": "index",\n  "timestamp": "2024-05-20T10:15:35.500Z",\n  "data": [\n    {\n      "index_code": "KSE100",\n      "index_name": "KSE-100 Index",\n      "value": 67890.12,\n      "change": 120.45,\n      "change_percent": 0.18,\n      "high": 67950.00,\n      "low": 67700.00,\n      "volume": 15000000\n    }\n  ]\n}',
                'market-status-sub': '{\n  "action": "subscribe",\n  "stream": "market_status"\n}',
                'market-status-update': '{\n  "stream": "market_status",\n  "timestamp": "2024-05-20T09:30:00.000Z",\n  "data": {\n    "status": "open",\n    "message": "Regular Trading Session",\n    "next_status_change": "2024-05-20T15:30:00+05:00"\n  }\n}',
                'login-req': '{\n  "login_id": "user@email.com",\n  "password": "user_password",\n  "device_id": "unique_device_fingerprint",\n  "device_type": "mobile"\n}',
                'login-res': '{\n  "status": "success",\n  "code": 200,\n  "message": "Authentication successful.",\n  "data": {\n    "access_token": "eyJhbGciOiJIUzI1NiIs...",\n    "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg==",\n    "token_type": "Bearer",\n    "expires_in": 3600,\n    "user": {\n      "user_id": "12345",\n      "full_name": "Alex Peter",\n      "email": "alexpeter@gmail.com",\n      "account_status": "active",\n      "kyc_status": "approved"\n    }\n  },\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174000"\n}',
                'login-error': '{\n  "status": "error",\n  "code": 401,\n  "message": "Invalid login credentials or account locked.",\n  "error_details": {\n    "reason": "invalid_password",\n    "attempts_remaining": 2\n  },\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174001"\n}',
                'refresh-req': '{\n  "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg=="\n}',
                'refresh-res': '{\n  "status": "success",\n  "data": {\n    "access_token": "eyJhbGciOiJIUzI1NiIs...",\n    "expires_in": 3600\n  },\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174002"\n}',
                'logout-req': '{\n  "refresh_token": "dGhpc2lzYXJlZnJlc2h0b2tlbg=="\n}',
                'logout-res': '{\n  "status": "success",\n  "code": 200,\n  "message": "Successfully logged out.",\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174003"\n}',
                'order-req': '{\n  "symbol": "MEBL",\n  "side": "buy",\n  "order_type": "limit",\n  "quantity": 500,\n  "price": 187.50,\n  "trigger_price": 185.00,\n  "time_in_force": "day",\n  "display_quantity": 100,\n  "client_order_id": "my_order_ref_123"\n}',
                'order-res': '{\n  "status": "accepted",\n  "code": 202,\n  "message": "Order placed successfully and sent to exchange.",\n  "data": {\n    "order_id": "ODR123456789",\n    "client_order_id": "my_order_ref_123",\n    "symbol": "MEBL",\n    "side": "buy",\n    "order_type": "limit",\n    "quantity": 500,\n    "price": 187.50,\n    "status": "pending",\n    "reject_reason": null,\n    "order_time": "2024-05-20T10:20:00.123Z"\n  },\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174004"\n}',
                'order-error': '{\n  "status": "error",\n  "code": 400,\n  "message": "Order validation failed.",\n  "error_details": {\n    "field": "quantity",\n    "reason": "Invalid lot size. Must be a multiple of 500."\n  },\n  "request_id": "req-123e4567-e89b-12d3-a456-426614174005"\n}',
                'portfolio-summary': '{\n  "status": "success",\n  "data": {\n    "total_investment": 1250000.00,\n    "current_value": 1320000.00,\n    "total_pnl": 70000.00,\n    "total_pnl_percent": 5.6,\n    "day_change": 2500.00,\n    "day_change_percent": 0.19\n  },\n  "request_id": "..."\n}',
                'holdings-res': '{\n  "status": "success",\n  "data": {\n    "holdings": [\n      {\n        "symbol": "MEBL",\n        "quantity": 1000,\n        "average_price": 180.50,\n        "ltp": 187.50,\n        "current_value": 187500,\n        "unrealized_pnl": 7000,\n        "unrealized_pnl_percent": 3.88,\n        "day_change": 100,\n        "day_change_percent": 0.05\n      }\n    ]\n  },\n  "request_id": "..."\n}',
                'buying-power': '{\n  "status": "success",\n  "data": {\n    "net_equity": 1500000.00,\n    "cash_balance": 250000.00,\n    "available_margin": 1250000.00,\n    "used_margin": 250000.00,\n    "maintenance_margin": 75000.00\n  },\n  "request_id": "..."\n}',
                'webhook': '{\n  "event_id": "evt_abc123def",\n  "event_type": "order.execution",\n  "timestamp": "2024-05-20T10:21:00.000Z",\n  "data": {\n    "user_id": "12345",\n    "order_id": "ODR123456789",\n    "execution_details": {\n      "execution_id": "EXE987654",\n      "executed_quantity": 200,\n      "executed_price": 187.50,\n      "execution_time": "2024-05-20T10:20:59.500Z",\n      "remaining_quantity": 300,\n      "order_status": "partially_filled"\n    },\n    "reject_details": {\n      "reason_code": "INSUFFICIENT_BALANCE",\n      "reason_message": "Buying power check failed."\n    }\n  },\n  "version": "1.0"\n}',
                'webhook-ack': '{\n  "status": "received",\n  "event_id": "evt_abc123def"\n}'
            };
            
            if (jsons[type]) {
                navigator.clipboard.writeText(jsons[type]).then(() => {
                    addConsoleMessage('JSON', `${type} copied to clipboard`);
                }).catch(() => {
                    alert('JSON copied to clipboard!');
                });
            }
        }

        // PIN Input Handling
        document.addEventListener('DOMContentLoaded', function() {
            const pinInputs = document.querySelectorAll('.pin-digit');
            pinInputs.forEach((input, index) => {
                input.addEventListener('keyup', (e) => {
                    if (e.key >= '0' && e.key <= '9') {
                        if (index < pinInputs.length - 1) {
                            pinInputs[index + 1].focus();
                        }
                    } else if (e.key === 'Backspace') {
                        if (index > 0) {
                            pinInputs[index - 1].focus();
                        }
                    }
                });
            });

            // Chart generation
            function generateCandles() {
                const chart = document.getElementById('candleChart');
                if (!chart) return;
                
                chart.innerHTML = '';
                
                for (let i = 0; i < 30; i++) {
                    const container = document.createElement('div');
                    container.className = 'candle-container';
                    
                    const open = 187 + (Math.random() * 2);
                    const close = open + (Math.random() * 2 - 1);
                    const high = Math.max(open, close) + Math.random() * 0.5;
                    const low = Math.min(open, close) - Math.random() * 0.5;
                    
                    const isGreen = close >= open;
                    
                    const maxPrice = 190;
                    const minPrice = 185;
                    const priceRange = maxPrice - minPrice;
                    
                    const openPercent = (open - minPrice) / priceRange;
                    const closePercent = (close - minPrice) / priceRange;
                    const highPercent = (high - minPrice) / priceRange;
                    const lowPercent = (low - minPrice) / priceRange;
                    
                    const bodyHeight = Math.abs(closePercent - openPercent) * 250;
                    const wickTop = (highPercent - Math.max(openPercent, closePercent)) * 250;
                    const wickBottom = (Math.min(openPercent, closePercent) - lowPercent) * 250;
                    
                    container.innerHTML = `
                        <div class="candle-wick" style="height: ${wickTop + bodyHeight + wickBottom}px; top: ${-wickTop}px;"></div>
                        <div class="candle-body ${isGreen ? 'green' : 'red'}" style="height: ${bodyHeight}px; width: 80%;"></div>
                    `;
                    
                    chart.appendChild(container);
                }
            }

            // Update order book
            function updateOrderBook() {
                const bidsContainer = document.getElementById('orderBookBids');
                const asksContainer = document.getElementById('orderBookAsks');
                
                if (!bidsContainer || !asksContainer) return;
                
                bidsContainer.innerHTML = '';
                let totalBidVol = 0;
                for (let i = 0; i < 8; i++) {
                    const price = (187.00 - i * 0.10).toFixed(2);
                    const volume = Math.floor(500 + Math.random() * 2000);
                    totalBidVol += volume;
                    
                    const row = document.createElement('div');
                    row.className = 'order-book-row';
                    row.innerHTML = `
                        <span class="bid-price">${price}</span>
                        <span>${volume.toLocaleString()}</span>
                        <span>${(price * volume / 1000).toFixed(0)}K</span>
                    `;
                    bidsContainer.appendChild(row);
                }
                
                asksContainer.innerHTML = '';
                let totalAskVol = 0;
                for (let i = 1; i <= 8; i++) {
                    const price = (187.60 + i * 0.10).toFixed(2);
                    const volume = Math.floor(400 + Math.random() * 1500);
                    totalAskVol += volume;
                    
                    const row = document.createElement('div');
                    row.className = 'order-book-row';
                    row.innerHTML = `
                        <span class="ask-price">${price}</span>
                        <span>${volume.toLocaleString()}</span>
                        <span>${(price * volume / 1000).toFixed(0)}K</span>
                    `;
                    asksContainer.appendChild(row);
                }
                
                document.getElementById('totalBidVol').textContent = totalBidVol.toLocaleString();
                document.getElementById('totalAskVol').textContent = totalAskVol.toLocaleString();
            }

            // Initialize
            generateCandles();
            updateOrderBook();
            
            // Update every 3 seconds
            setInterval(() => {
                generateCandles();
                updateOrderBook();
                
                // Update price
                const change = (Math.random() - 0.5) * 0.5;
                basePrice = 187.50 + change;
                document.getElementById('currentPrice').textContent = basePrice.toFixed(2);
                document.getElementById('priceChange').innerHTML = (change >= 0 ? '‚ñ≤' : '‚ñº') + ' ' + Math.abs(change).toFixed(2) + ' (' + (change/187.50*100).toFixed(2) + '%)';
                
                // Update latency
                const latency = 8 + Math.floor(Math.random() * 15);
                document.getElementById('wsLatency').textContent = latency + 'ms';
                
                // Update tick rate
                const tickRate = 20 + Math.floor(Math.random() * 20);
                document.getElementById('tickRate').textContent = tickRate;
            }, 3000);

            connectWebSocket();
        });

        // Navigation scroll
        document.querySelectorAll('.nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
                link.classList.add('active');
                const targetId = link.getAttribute('href').substring(1);
                document.getElementById(targetId).scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>